webpackJsonp([11],{WU8w:function(t,e,a){"use strict";e.c=function(){return Object(i.a)({url:"/api/productype/result",method:"get"})},e.b=function(t){return Object(i.a)({url:"/api/productype/index",method:"get",params:t})},e.a=function(t){return Object(i.a)({url:"/api/productype/save",method:"post",data:t})},e.e=function(t){return Object(i.a)({url:"/api/productype/update",method:"post",data:t})},e.d=function(t){return Object(i.a)({url:"/api/productype/remove/"+t,method:"delete"})};var i=a("vLgD")},sM9j:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),l=a.n(i),n=a("WU8w"),o=a("cAgV"),s=(a("0xDb"),{name:"productTypeTable",directives:{waves:o.a},data:function(){return{tableKey:0,appendTo:!0,list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,label:void 0},temp:{id:void 0,label:"",parent:""},editTemp:{id:void 0,label:"",parent:""},treeTemp:{id:void 0,label:"",parent:""},dialogFormVisible:!1,dialogDetailVisible:!1,dialogFormSonVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加",detail:"查看"},rules:{label:[{required:!0,message:"名称不能为空",trigger:"blur"}],labelSon:[{required:!0,message:"名称不能为空",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(n.b)(this.listQuery).then(function(e){t.list=e.data.data,t.total=e.data.count,t.listLoading=!1})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleUploadSuccess:function(t,e){this.temp.logo="http://api.newtecharmor.com/"+t.result},resetTemp:function(){this.temp={id:void 0,name:"",parent:""}},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},createDataCancel:function(){this.dialogFormVisible=!1},editDataCancel:function(){this.dialogFormVisible=!1},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){e&&Object(n.a)(t.temp).then(function(e){t.getList(),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})},handleDetail:function(t){var e=l()({},t);this.treeTemp=new Array,this.treeTemp.push(e),this.temp=e,console.log(this.treeTemp),this.dialogStatus="detail",this.dialogDetailVisible=!0},handleAddSon:function(t){var e=this;this.dialogStatus="create",this.dialogFormSonVisible=!0,this.$nextTick(function(){e.$refs.dataSonForm.clearValidate()})},createSonData:function(){var t=this;this.$refs.dataSonForm.validate(function(e){if(e){var a=l()({},t.temp);a.parent=t.temp.id,a.id=void 0,a.label=t.temp.labelSon,Object(n.a)(a).then(function(e){t.dialogFormSonVisible=!1,t.dialogDetailVisible=!1,t.getList(),t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})}})},handleUpdate:function(t){var e=this;this.temp=l()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=l()({},t.temp);Object(n.e)(a).then(function(){t.getList(),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}})},removeSon:function(t,e){var a=this;this.$confirm("确认删除"+t.label+"分类以及该分类下的产品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)(e.id).then(function(){var i=t.parent,l=i.data.children||i.data,n=l.findIndex(function(t){return t.id===e.id});l.splice(n,1),a.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},handleDelete:function(t){var e=this;this.$confirm("确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)(t.id).then(function(){var a=e.list.indexOf(t);e.list.splice(a,1),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}}}),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:t.$t("table.title")},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleFilter(e)}},model:{value:t.listQuery.label,callback:function(e){t.$set(t.listQuery,"label",e)},expression:"listQuery.label"}}),t._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(t._s(t.$t("table.search")))]),t._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v(t._s(t.$t("table.add")))])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",type:"index",width:"65"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150px",label:"名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type",on:{click:function(a){t.handleUpdate(e.row)}}},[t._v(t._s(e.row.label))])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"110px",align:"center",label:"二级分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type",on:{click:function(a){t.handleDetail(e.row)}}},[t._v("查看")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:t.$t("table.actions"),width:"380","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.handleUpdate(e.row)}}},[t._v(t._s(t.$t("table.edit")))]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v(t._s(t.$t("table.delete"))+"\n        ")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[5,10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticClass:"form-container",staticStyle:{width:"80%","margin-left":"50px"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"90px"}},[a("el-form-item",{attrs:{label:"名称",prop:"label"}},[a("el-input",{model:{value:t.temp.label,callback:function(e){t.$set(t.temp,"label",e)},expression:"temp.label"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.createDataCancel}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v(t._s(t.$t("table.confirm")))]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v(t._s(t.$t("table.confirm")))])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormSonVisible,"append-to-body":t.appendTo},on:{"update:visible":function(e){t.dialogFormSonVisible=e}}},[a("el-form",{ref:"dataSonForm",staticClass:"form-container",staticStyle:{width:"80%","margin-left":"50px"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"90px"}},[a("el-form-item",{attrs:{label:"一级分类",prop:"parent"}},[a("el-input",{attrs:{readonly:"readonly"},model:{value:t.temp.label,callback:function(e){t.$set(t.temp,"label",e)},expression:"temp.label"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分类名称",prop:"labelSon"}},[a("el-input",{model:{value:t.temp.labelSon,callback:function(e){t.$set(t.temp,"labelSon",e)},expression:"temp.labelSon"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormSonVisible=!1}}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createSonData}},[t._v(t._s(t.$t("table.confirm")))])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogDetailVisible},on:{"update:visible":function(e){t.dialogDetailVisible=e}}},[a("el-tree",{attrs:{data:t.treeTemp,"show-checkbox":"","node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,l=e.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[t._v(t._s(i.label))]),t._v(" "),a("span",[0!=l.parent?a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return t.removeSon(i,l)}}},[t._v("\n              删除\n            ")]):t._e()],1)])}}])}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleAddSon}},[t._v("新增二级分类")]),t._v(" "),a("el-button",{on:{click:function(e){t.dialogDetailVisible=!1}}},[t._v("关闭")])],1)],1)],1)},staticRenderFns:[]},c=a("VU/8")(s,r,!1,null,null,null);e.default=c.exports}});