webpackJsonp([2],{"5aCZ":function(t,e,i){"use strict";var a=i("//Fk"),n=i.n(a),l=i("fZjL"),s=i.n(l),o={name:"editorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{uploadUrl:"http://api.newtecharmor.com/rest/upload",dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return s()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=s()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(console.log(e),this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var i=e.uid,a=s()(this.listObj),n=0,l=a.length;n<l;n++)if(this.listObj[a[n]].uid===i)return this.listObj[a[n]].url=t.result,void(this.listObj[a[n]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,i=s()(this.listObj),a=0,n=i.length;a<n;a++)if(this.listObj[i[a]].uid===e)return void delete this.listObj[i[a]]},beforeUpload:function(t){var e=this,i=window.URL||window.webkitURL,a=t.uid;return this.listObj[a]={},new n.a(function(n,l){var s=new Image;s.src=i.createObjectURL(t),s.onload=function(){e.listObj[a]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},n(!0)})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n  ")]),t._v(" "),i("el-dialog",{attrs:{"append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{action:t.uploadUrl,multiple:!0,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var c=["advlist anchor autolink code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools importcss insertdatetime legacyoutput link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],d=["bold italic underline fontselect fontsizeselect strikethrough alignleft aligncenter alignright alignjustify outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap\t preview anchor pagebreak fullscreen insertdatetime media table emoticons forecolor backcolor"],u={name:"tinymce",components:{editorImage:i("VU/8")(o,r,!1,function(t){i("9+rS")},"data-v-53d43213",null).exports},props:{id:{type:String},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id||"vue-tinymce-"+ +new Date}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t)})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;window.tinymce.init({selector:"#"+this.tinymceId,height:this.height,language:"zh_CN",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:d,menubar:this.menubar,plugins:c,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,init_instance_callback:function(i){e.value&&i.setContent(e.value),e.hasInit=!0,i.on("NodeChange Change KeyUp SetContent",function(){t.hasChange=!0,t.$emit("input",i.getContent())})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){var e=this;t.forEach(function(t){window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="http://api.newtecharmor.com/'+t.url+'" >')})}},destroyed:function(){this.destroyTinymce()}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),e("div",{staticClass:"editor-custom-btn-container"},[e("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},staticRenderFns:[]};var m=i("VU/8")(u,p,!1,function(t){i("dJPl")},"data-v-c81b1a7c",null);e.a=m.exports},"74xB":function(t,e,i){var a=i("K5Oh");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("293cb576",a,!0)},"9+rS":function(t,e,i){var a=i("bdcu");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("3ce6dd66",a,!0)},K5Oh:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n",""])},WU8w:function(t,e,i){"use strict";e.c=function(){return Object(a.a)({url:"/api/productype/result",method:"get"})},e.b=function(t){return Object(a.a)({url:"/api/productype/index",method:"get",params:t})},e.a=function(t){return Object(a.a)({url:"/api/productype/save",method:"post",data:t})},e.e=function(t){return Object(a.a)({url:"/api/productype/update",method:"post",data:t})},e.d=function(t){return Object(a.a)({url:"/api/productype/remove/"+t,method:"delete"})};var a=i("vLgD")},XbZC:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.tinymce-container[data-v-c81b1a7c] {\n  position: relative;\n}\n.tinymce-container[data-v-c81b1a7c] .mce-fullscreen {\n  z-index: 10000;\n}\n.tinymce-textarea[data-v-c81b1a7c] {\n  visibility: hidden;\n  z-index: -1;\n}\n.editor-custom-btn-container[data-v-c81b1a7c] {\n  position: absolute;\n  right: 4px;\n  top: 4px;\n  /*z-index: 2005;*/\n}\n.editor-upload-btn[data-v-c81b1a7c] {\n  display: inline-block;\n}\n",""])},bdcu:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.upload-container .editor-slide-upload[data-v-53d43213] {\n  margin-bottom: 20px;\n}\n",""])},dJPl:function(t,e,i){var a=i("XbZC");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("a06d04f4",a,!0)},hGdN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),n=i.n(a),l=i("5aCZ"),s=i("vLgD");var o=i("WU8w"),r=i("cAgV"),c=(i("0xDb"),0),d={name:"productTable",directives:{waves:r.a},components:{Tinymce:l.a},data:function(){return{uploadUrl:"http://api.newtecharmor.com/rest/upload",tableKey:0,list:null,total:null,typeList:null,detailTypeList:[],listLoading:!0,imageList:[],imageListArr:[],dialogImageUrl:"",listQuery:{page:1,limit:20,title:void 0,showIndex:void 0},detailValue:"",temp:{id:void 0,gmtCreate:"",title:"",detail:"",intro:"",seoTitle:"",seoDescription:"",seoKeyword:"",productTypeId:"",productTypeParentId:"",productTypeName:"",productTypeParentName:"",logo:null},editTemp:{id:void 0,gmtCreate:"",title:"",detail:"",intro:"",productTypeId:"",productTypeParentId:"",productTypeName:"",productTypeParentName:"",seoTitle:"",seoDescription:"",seoKeyword:"",logo:null},fullScreen:!1,imagePreviewVisible:!1,dialogFormVisible:!1,dialogDetailVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"添加",detail:"查看"},rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],intro:[{required:!0,message:"介绍不能为空",trigger:"blur"}],typeList:[{required:!0,message:"分类不能为空",trigger:"change"}],detail:[{required:!0,message:"详情不能为空",trigger:"change"}],logo:[{required:!0,message:"图片不能为空",trigger:"change"}]}}},created:function(){this.getList(),this.getTypeList()},methods:{getList:function(){var t,e=this;this.listLoading=!0,(t=this.listQuery,Object(s.a)({url:"/api/product/list",method:"get",params:t})).then(function(t){e.list=t.data.data,e.total=t.data.count,e.listLoading=!1})},getTypeList:function(){var t=this;Object(o.c)().then(function(e){t.typeList=e.data})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleSizeChange:function(t){this.listQuery.limit=t,this.getList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getList()},handleUploadSuccess:function(t,e){this.imageListArr.push(t.result)},resetTemp:function(){this.temp={id:void 0,gmtCreate:"",title:"",detail:"",intro:"",logo:null}},handleImageRemove:function(t,e){void 0!=t.response&&this.imageListArr.remove(t.response.result),this.imageListArr.remove(t.url.substring(t.url.lastIndexOf("/")+1,t.url.length)),console.log(this.imageListArr)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.imagePreviewVisible=!0},handleCreate:function(){var t=this;this.resetTemp(),this.detailTypeList=[],this.imageList=[],this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){c>0&&(t.$refs.editorTiny.setContent(t.temp.detail),t.$refs.editorIntro.setContent(t.temp.intro)),t.$refs.dataForm.clearValidate()})},createDataCancel:function(){this.dialogFormVisible=!1},editDataCancel:function(){this.dialogFormVisible=!1},createData:function(){var t=this;this.temp.logo=this.imageListArr.join(","),console.log(this.detailTypeList[1]),this.$refs.dataForm.validate(function(e){var i;e&&(t.temp.productTypeId=t.detailTypeList[1],(i=t.temp,Object(s.a)({url:"/api/product/save",method:"post",data:i})).then(function(e){t.getList(),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}))})},handleIntro:function(t){this.editTemp=n()({},t),this.detailValue=this.editTemp.intro,this.dialogStatus="detail",this.dialogDetailVisible=!0},handleDetail:function(t){this.editTemp=n()({},t),this.detailValue=this.editTemp.detail,this.dialogStatus="detail",this.dialogDetailVisible=!0},handleUpdate:function(t){var e=this;this.detailTypeList=[],this.temp=n()({},t),this.detailTypeList.push(this.temp.productTypeParentId),this.detailTypeList.push(this.temp.productTypeId),console.log(this.detailTypeList),this.imageList=[],this.imageListArr=[];for(var i=this.temp.logo.split(","),a=0;a<i.length;a++)this.imageList.push({url:"http://api.newtecharmor.com/"+i[a]}),this.imageListArr.push(i[a]);this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){c>0&&(e.$refs.editorTiny.setContent(t.detail),e.$refs.editorIntro.setContent(t.intro)),e.$refs.dataForm.clearValidate(),c++})},updateData:function(){var t=this;this.temp.logo=this.imageListArr.join(","),this.temp.productTypeId=this.detailTypeList[1],this.$refs.dataForm.validate(function(e){if(e){var i=n()({},t.temp);(a=i,Object(s.a)({url:"/api/product/update",method:"post",data:a})).then(function(){t.getList(),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})})}var a})},handleDelete:function(t){var e=this;this.$confirm("确认删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i;(i=t.id,Object(s.a)({url:"/api/product/remove/"+i,method:"delete"})).then(function(){var i=e.list.indexOf(t);e.list.splice(i,1),e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container calendar-list-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:t.$t("table.title")},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleFilter(e)}},model:{value:t.listQuery.title,callback:function(e){t.$set(t.listQuery,"title",e)},expression:"listQuery.title"}}),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v(t._s(t.$t("table.search")))]),t._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v(t._s(t.$t("table.add")))])],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",type:"index",width:"65"}}),t._v(" "),i("el-table-column",{attrs:{width:"160px",align:"center",label:t.$t("table.gmtCreate")},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.gmtCreate))])]}}])}),t._v(" "),i("el-table-column",{attrs:{"min-width":"150px",label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link-type",on:{click:function(i){t.handleUpdate(e.row)}}},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"160px",align:"center",label:"一级分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.productTypeParentName))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"160px",align:"center",label:"二级分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",[t._v(t._s(e.row.productTypeName))])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"110px",align:"center",label:"商品介绍"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link-type",on:{click:function(i){t.handleIntro(e.row)}}},[t._v("查看介绍")])]}}])}),t._v(" "),i("el-table-column",{attrs:{width:"110px",align:"center",label:"商品详情"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{staticClass:"link-type",on:{click:function(i){t.handleDetail(e.row)}}},[t._v("查看详情")])]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:t.$t("table.actions"),width:"230","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){t.handleUpdate(e.row)}}},[t._v(t._s(t.$t("table.edit")))]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){t.handleDelete(e.row)}}},[t._v(t._s(t.$t("table.delete"))+"\n        ")])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[5,10,20,30,50],"page-size":t.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,fullscreen:t.fullScreen,top:"5vh",width:"80%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"dataForm",staticClass:"form-container",staticStyle:{width:"80%","margin-left":"50px"},attrs:{rules:t.rules,model:t.temp,"label-position":"left","label-width":"90px"}},[i("el-form-item",{attrs:{label:"图片",prop:"logo"}},[i("el-upload",{attrs:{action:t.uploadUrl,"on-success":t.handleUploadSuccess,"file-list":t.imageList,multiple:"","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"on-remove":t.handleImageRemove}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.imagePreviewVisible,"append-to-body":""},on:{"update:visible":function(e){t.imagePreviewVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),i("el-form-item",{attrs:{label:"商品标题",prop:"title"}},[i("el-input",{model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title",e)},expression:"temp.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"商品分类",prop:"detailTypeList"}},[i("el-cascader",{attrs:{options:t.typeList},model:{value:t.detailTypeList,callback:function(e){t.detailTypeList=e},expression:"detailTypeList"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"商品介绍",prop:"title"}},[i("div",{staticClass:"editor-container"},[i("tinymce",{ref:"editorIntro",attrs:{height:260},model:{value:t.temp.intro,callback:function(e){t.$set(t.temp,"intro",e)},expression:"temp.intro"}})],1)]),t._v(" "),i("el-form-item",{attrs:{label:"商品详情",prop:"detail"}},[i("div",{staticClass:"editor-container"},[i("tinymce",{ref:"editorTiny",attrs:{height:260},model:{value:t.temp.detail,callback:function(e){t.$set(t.temp,"detail",e)},expression:"temp.detail"}})],1)]),t._v(" "),i("el-form-item",{attrs:{label:"SEO标题",prop:"seoTitle"}},[i("el-input",{model:{value:t.temp.seoTitle,callback:function(e){t.$set(t.temp,"seoTitle",e)},expression:"temp.seoTitle"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"SEO描述",prop:"seoDescription"}},[i("el-input",{model:{value:t.temp.seoDescription,callback:function(e){t.$set(t.temp,"seoDescription",e)},expression:"temp.seoDescription"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"SEO关键词",prop:"seoKeyword"}},[i("el-input",{model:{value:t.temp.seoKeyword,callback:function(e){t.$set(t.temp,"seoKeyword",e)},expression:"temp.seoKeyword"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.createDataCancel}},[t._v(t._s(t.$t("table.cancel")))]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v(t._s(t.$t("table.confirm")))]):i("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v(t._s(t.$t("table.confirm")))])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogDetailVisible,width:"80%",top:"5vh"},on:{"update:visible":function(e){t.dialogDetailVisible=e}}},[i("el-form",{ref:"detailForm",staticClass:"form-container",staticStyle:{width:"80%","margin-left":"50px"},attrs:{"label-position":"left","label-width":"90px"}},[i("span",{domProps:{innerHTML:t._s(t.detailValue)}})]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogDetailVisible=!1}}},[t._v("关闭")])],1)],1)],1)},staticRenderFns:[]};var p=i("VU/8")(d,u,!1,function(t){i("74xB")},null,null);e.default=p.exports}});